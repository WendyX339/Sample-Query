SELECT
  HAR_USER_LOGIN.USER_ID,
  HAR_USERS.FIRST_NAME,
  HAR_USERS.LAST_NAME,
  HAR_USERS.LAST_NAME + ', ' + HAR_USERS.FIRST_NAME AS [Full Name],
  HAR_USERS.LAST_NAME + ', ' + HAR_USERS.FIRST_NAME + '  (' + HAR_USER_LOGIN.USER_ID + ')' AS [Param Label],
  HAR_USERS.USER_UUID,
  HAR_USER_LOGIN.START_DATE,
  HAR_USER_LOGIN.EXPIRATION_DATE,
  HAR_USER_LOGIN.LAST_LOGIN_DATETIME
FROM
  HAR_USERS
  INNER JOIN HAR_USER_LOGIN ON HAR_USERS.USER_UUID = HAR_USER_LOGIN.USER_UUID
WHERE
  HAR_USER_LOGIN.AGENCY = @AGENCY
  AND HAR_USER_LOGIN.LAST_LOGIN_DATETIME >= @LAST_LOGIN_DATETIME
GROUP BY
  HAR_USER_LOGIN.USER_ID,
  HAR_USERS.FIRST_NAME,
  HAR_USERS.LAST_NAME,
  HAR_USERS.USER_UUID,
  HAR_USER_LOGIN.START_DATE,
  HAR_USER_LOGIN.EXPIRATION_DATE,
  HAR_USER_LOGIN.LAST_LOGIN_DATETIME
ORDER BY
  HAR_USERS.LAST_NAME,
  HAR_USERS.FIRST_NAME
